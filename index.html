<!DOCTYPE html>
<html>
<head>
  <title>Mini Trading</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      background:#111;
      color:white;
      font-family:Arial;
      text-align:center;
      padding:40px;
    }
    select, button {
      padding:10px;
      margin:10px;
    }
    pre {
      text-align:left;
      margin-top:30px;
      background:#222;
      padding:20px;
      overflow:auto;
    }
  </style>
</head>
<body>

<h1>Mini Trading ðŸ“ˆ</h1>

<select id="tickerSelect"></select>
<button onclick="loadData()">Carregar</button>

<pre id="output"></pre>

<script>
  const { createClient } = supabase;
  const client = createClient(
    "https://vlqteefeuxhovubojybd.supabase.co",
    "sb_publishable_KmHWU0IJzCkwXBWzWMe1WQ_M-sSaxk0"
  );

  async function loadTickers() {
    const { data, error } = await client
      .from("prices")
      .select("ticker");

    if (error) {
      document.getElementById("output").innerText = error.message;
      return;
    }

    const uniqueTickers = [...new Set(data.map(item => item.ticker))];

    const select = document.getElementById("tickerSelect");
    select.innerHTML = "";
    uniqueTickers.forEach(ticker => {
      const option = document.createElement("option");
      option.value = ticker;
      option.textContent = ticker;
      select.appendChild(option);
    });
  }

  async function loadData() {
    const ticker = document.getElementById("tickerSelect").value;

    const { data, error } = await client
      .from("prices")
      .select("*")
      .eq("ticker", ticker)
      .order("date", { ascending: true });

    if (error) {
      document.getElementById("output").innerText = error.message;
      return;
    }

    document.getElementById("output").innerText =
      JSON.stringify(data, null, 2);
  }

  loadTickers();
</script>

</body>
</html>
